



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Orb2019 - $TEAMNAME">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.2.0">
    
    
      
        <title>Three - Orb2019 - $TEAMNAME</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.750b69bd.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Gentium+Book+Basic">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700">
    
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#milestone-3" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Orb2019 - $TEAMNAME" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Orb2019 - $TEAMNAME
            </span>
            <span class="md-header-nav__topic">
              Three
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Orb2019 - $TEAMNAME" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Orb2019 - $TEAMNAME
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Milestones
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Milestones
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../milestone_one/" title="One" class="md-nav__link">
      One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../milestone_two/" title="Two" class="md-nav__link">
      Two
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Three
      </label>
    
    <a href="./" title="Three" class="md-nav__link md-nav__link--active">
      Three
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-overview" title="1. Overview" class="md-nav__link">
    1. Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-revamp-of-site-ui" title="2. Revamp of Site UI" class="md-nav__link">
    2. Revamp of Site UI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-calorie-counter" title="3. Calorie Counter" class="md-nav__link">
    3. Calorie Counter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-typeaheadjs-technical-details" title="3.1 typeahead.js technical details" class="md-nav__link">
    3.1 typeahead.js technical details
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-typeaheadjs-bug" title="3.2 typeahead.js bug" class="md-nav__link">
    3.2 typeahead.js bug
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-input-validation" title="3.3 Input Validation" class="md-nav__link">
    3.3 Input Validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-empty-rows" title="3.4 Empty Rows" class="md-nav__link">
    3.4 Empty Rows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-piechart-for-results" title="3.5 Piechart for Results" class="md-nav__link">
    3.5 Piechart for Results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-food-database" title="3.6 Food Database" class="md-nav__link">
    3.6 Food Database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-user-accounts-and-sign-ins" title="4. User Accounts and Sign-ins" class="md-nav__link">
    4. User Accounts and Sign-ins
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-nist-password-guidelines" title="4.1 NIST Password Guidelines" class="md-nav__link">
    4.1 NIST Password Guidelines
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-information-transfer" title="4.2 Information Transfer" class="md-nav__link">
    4.2 Information Transfer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-registration" title="4.3 Registration" class="md-nav__link">
    4.3 Registration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-logins" title="4.4 Logins" class="md-nav__link">
    4.4 Logins
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-session-id" title="4.5 Session ID" class="md-nav__link">
    4.5 Session ID
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-saving-recipes-to-database" title="5. Saving Recipes to Database" class="md-nav__link">
    5. Saving Recipes to Database
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-front-end" title="5.1 Front-end" class="md-nav__link">
    5.1 Front-end
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#delete" title=""Delete"" class="md-nav__link">
    "Delete"
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-undo" title="5.2 undo" class="md-nav__link">
    5.2 undo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-back-end" title="5.3 Back-end" class="md-nav__link">
    5.3 Back-end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-method-of-storage" title="5.4 Method of Storage" class="md-nav__link">
    5.4 Method of Storage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-night-mode" title="6. Night Mode" class="md-nav__link">
    6. Night Mode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-graph-generator" title="7. Graph Generator" class="md-nav__link">
    7. Graph Generator
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-rationale" title="7.1 Rationale" class="md-nav__link">
    7.1 Rationale
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-implementation" title="7.2 Implementation" class="md-nav__link">
    7.2 Implementation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-user-testing" title="8. User Testing" class="md-nav__link">
    8. User Testing
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-difficulty-of-inputting-standard-ingredients" title="8.1 Difficulty of Inputting Standard Ingredients" class="md-nav__link">
    8.1 Difficulty of Inputting Standard Ingredients
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-error-handling" title="8.2 Error Handling" class="md-nav__link">
    8.2 Error Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-meaningful-user-interactions-with-the-ui" title="8.3 Meaningful User Interactions with the UI" class="md-nav__link">
    8.3 Meaningful User Interactions with the UI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84-undo-functionality" title="8.4 undo Functionality" class="md-nav__link">
    8.4 undo Functionality
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-project-conclusion" title="9. Project Conclusion" class="md-nav__link">
    9. Project Conclusion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-deliverables" title="10. Deliverables" class="md-nav__link">
    10. Deliverables
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-poster" title="10.1 Poster" class="md-nav__link">
    10.1 Poster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-project-log" title="10.2 Project Log" class="md-nav__link">
    10.2 Project Log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-video" title="10.3 Video" class="md-nav__link">
    10.3 Video
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-overview" title="1. Overview" class="md-nav__link">
    1. Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-revamp-of-site-ui" title="2. Revamp of Site UI" class="md-nav__link">
    2. Revamp of Site UI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-calorie-counter" title="3. Calorie Counter" class="md-nav__link">
    3. Calorie Counter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-typeaheadjs-technical-details" title="3.1 typeahead.js technical details" class="md-nav__link">
    3.1 typeahead.js technical details
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-typeaheadjs-bug" title="3.2 typeahead.js bug" class="md-nav__link">
    3.2 typeahead.js bug
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-input-validation" title="3.3 Input Validation" class="md-nav__link">
    3.3 Input Validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-empty-rows" title="3.4 Empty Rows" class="md-nav__link">
    3.4 Empty Rows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-piechart-for-results" title="3.5 Piechart for Results" class="md-nav__link">
    3.5 Piechart for Results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-food-database" title="3.6 Food Database" class="md-nav__link">
    3.6 Food Database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-user-accounts-and-sign-ins" title="4. User Accounts and Sign-ins" class="md-nav__link">
    4. User Accounts and Sign-ins
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-nist-password-guidelines" title="4.1 NIST Password Guidelines" class="md-nav__link">
    4.1 NIST Password Guidelines
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-information-transfer" title="4.2 Information Transfer" class="md-nav__link">
    4.2 Information Transfer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-registration" title="4.3 Registration" class="md-nav__link">
    4.3 Registration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-logins" title="4.4 Logins" class="md-nav__link">
    4.4 Logins
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-session-id" title="4.5 Session ID" class="md-nav__link">
    4.5 Session ID
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-saving-recipes-to-database" title="5. Saving Recipes to Database" class="md-nav__link">
    5. Saving Recipes to Database
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-front-end" title="5.1 Front-end" class="md-nav__link">
    5.1 Front-end
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#delete" title=""Delete"" class="md-nav__link">
    "Delete"
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-undo" title="5.2 undo" class="md-nav__link">
    5.2 undo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-back-end" title="5.3 Back-end" class="md-nav__link">
    5.3 Back-end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-method-of-storage" title="5.4 Method of Storage" class="md-nav__link">
    5.4 Method of Storage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-night-mode" title="6. Night Mode" class="md-nav__link">
    6. Night Mode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-graph-generator" title="7. Graph Generator" class="md-nav__link">
    7. Graph Generator
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-rationale" title="7.1 Rationale" class="md-nav__link">
    7.1 Rationale
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-implementation" title="7.2 Implementation" class="md-nav__link">
    7.2 Implementation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-user-testing" title="8. User Testing" class="md-nav__link">
    8. User Testing
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-difficulty-of-inputting-standard-ingredients" title="8.1 Difficulty of Inputting Standard Ingredients" class="md-nav__link">
    8.1 Difficulty of Inputting Standard Ingredients
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-error-handling" title="8.2 Error Handling" class="md-nav__link">
    8.2 Error Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-meaningful-user-interactions-with-the-ui" title="8.3 Meaningful User Interactions with the UI" class="md-nav__link">
    8.3 Meaningful User Interactions with the UI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84-undo-functionality" title="8.4 undo Functionality" class="md-nav__link">
    8.4 undo Functionality
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-project-conclusion" title="9. Project Conclusion" class="md-nav__link">
    9. Project Conclusion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-deliverables" title="10. Deliverables" class="md-nav__link">
    10. Deliverables
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-poster" title="10.1 Poster" class="md-nav__link">
    10.1 Poster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-project-log" title="10.2 Project Log" class="md-nav__link">
    10.2 Project Log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-video" title="10.3 Video" class="md-nav__link">
    10.3 Video
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="milestone-3">Milestone 3</h1>
<p><strong>Proposed Level of Achievement:</strong> Apollo 11</p>
<h2 id="1-overview">1. Overview</h2>
<p>This is the final milestone. With that, this README will document</p>
<ol>
<li>The features we implemented in our calorie counter webpage</li>
<li>The challenges we faced in implementing such features</li>
<li>The steps we took to overcome these challenges</li>
<li>User testing and additional considerations taken</li>
</ol>
<p>The site can be found at this <a href="https://lyskevin.pythonanywhere.com">link</a>.
The image and piechart/graph load times are a bit slow since we use a
free hosting service (<a href="https://www.pythonanywhere.com">PythonAnywhere</a>).</p>
<p>You may navigate around the website using the top navigation bar. Certain
features only usable by users that have logged in may only be accessed via 
registration of an account, and then logging in. Unregistered users, however,
have access to the calorie counter itself.</p>
<h2 id="2-revamp-of-site-ui">2. Revamp of Site UI</h2>
<p>The original design was a bit plain, so we decided to make some changes to the
site's UI.</p>
<ol>
  <li>
    We removed the sidenav entirely as it only gave us issues viewing the
    platform on mobile, moving the sidenav links and elements to the topnav.
    This made it easier to view the website on mobile, such as the following:
    <br><br>
    <div class='wrapper-center'>
      <img src="../figures/ms3/mob_view.PNG" alt="typeahead gif">
    </div>
    <br>
  </li>
  <li>
    All images used are either our own, or images sourced from
    <a href='https://www.pexels.com/search/food/'>this website</a>.
  </li>
  <li>
    In general, the site looks more appealing to the eye.
  </li>
</ol>

<h2 id="3-calorie-counter">3. Calorie Counter</h2>
<p>This was already shown in the prototype to work, there are however, a few
aspects that we would like to talk about in this section.</p>
<h3 id="31-typeaheadjs-technical-details">3.1 <code class="codehilite"><span class="n">typeahead</span><span class="p">.</span><span class="n">js</span></code> technical details</h3>
<p>The <code class="codehilite"><span class="n">typeahead</span></code> box is actually just a wrapper around each <code class="codehilite"><span class="o">&lt;</span><span class="k">input</span><span class="o">&gt;</span></code> tag.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;twitter-typeahead&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;position: relative; display: inline-block;&quot;</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- Input box --&gt;</span>
<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>A <code class="codehilite"><span class="n">configure</span><span class="p">()</span></code> method is called on each input box that wraps the <code class="codehilite"><span class="n">typeahead</span></code>
object around each one. Every character typed queries the database using a
regex, this allows for dynamic ingredient searching while the user types their
desired query.</p>
<h3 id="32-typeaheadjs-bug">3.2 <code class="codehilite"><span class="n">typeahead</span><span class="p">.</span><span class="n">js</span></code> bug</h3>
<p>Unbeknownst to us, the prototype shown in Milestone Two had a rather annoying
bug that presented itself when one added rows to the calorie counter. In order
to do input validation, we forced the user to select options from the
drop-down menu, using Twitter's <code class="codehilite"><span class="n">typeahead</span><span class="p">.</span><span class="n">js</span></code>:</p>
<div class="wrapper-center">
  <img src="../figures/ms3/typeahead_1.gif" alt="typeahead gif">
  <p>The recording software glitched a bit...</p>
</div>

<p>If multiple rows were added at the start, and users tried to select options
from the drop-down menu, they would have to click multiple times in order to
select that item properly. If the item was far down the drop-down menu, the
menu would refresh and be brought back to the first entry. This made a menu
with many entries and selecting an item far down the menu an exercise in
frustration.</p>
<div class="wrapper-center">
  <img src="../figures/ms3/typeahead_2.gif" alt="typeahead 2 gif">
  <p>Five rows, so need to click five times</p>
</div>

<p>We came to realise that all input fields which make use of typeahead's
functionality were styled with the <code class="codehilite"><span class="n">typeahead</span></code> CSS class. This was a naming
decision which we had made when we first started working on the autocomplete
feature and subsequently forgot about. Hence, it came back to cause many bugs
and we finally found out about it after rigorous unit testing.</p>
<h3 id="33-input-validation">3.3 Input Validation</h3>
<p>A big part of simplifying the back-end was to restrict users in selecting
the ingredients. In order to do this, we simply made the unit field
unselectable until the user clicked something from the drop-down menu. This
would trigger the <code class="codehilite"><span class="n">Please</span> <span class="n">fill</span> <span class="k">in</span> <span class="k">all</span> <span class="k">input</span> <span class="n">fields</span></code> alert, hence forcing the
user to pick something from the drop-down menu.</p>
<h3 id="34-empty-rows">3.4 Empty Rows</h3>
<p>We received feedback in Milestone Two that empty rows in the table would not
allow the user to submit the form using the <strong>Analyze Calories</strong> button. We
originally forced the user to fill in all input fields within the form in order
to submit it using a simple boolean check. We added in a simple <code class="codehilite"><span class="k">if</span></code> check to
continue processing the rest of the ingredients if an empty row was found.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">function</span> <span class="nx">isAnEmptyRow</span><span class="p">(</span><span class="nx">desc</span><span class="p">,</span> <span class="nx">amount</span><span class="p">,</span> <span class="nx">unit</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">desc</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">amount</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">unit</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>This seems to work well without issues.</p>
<h3 id="35-piechart-for-results">3.5 Piechart for Results</h3>
<p>The calorie counter now displays a piechart, giving users at a glance what
ingredients contribute the most to the overall caloric amount. This fulfilled
one of the features we wanted to add to the website.</p>
<p>For this feature, we used the
<a href="https://developers.google.com/chart/interactive/docs/gallery/piechart">Google Charts API</a>
to render the chart.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">function</span> <span class="nx">drawChart</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">google</span><span class="p">.</span><span class="nx">visualization</span><span class="p">.</span><span class="nx">arrayToDataTable</span><span class="p">(</span><span class="nx">breakdown</span><span class="p">);</span>
  <span class="kd">let</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;dark&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Breakdown&quot;</span><span class="p">,</span>
      <span class="nx">titleTextStyle</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;white&#39;</span>
      <span class="p">},</span>
      <span class="nx">legend</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">textStyle</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;white&#39;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#232b2b&#39;</span><span class="p">,</span>
      <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;white&#39;</span>
    <span class="p">};</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Breakdown&quot;</span>
    <span class="p">};</span>
  <span class="p">}</span>
  <span class="kd">var</span> <span class="nx">chart</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">visualization</span><span class="p">.</span><span class="nx">PieChart</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;piechart&quot;</span><span class="p">));</span>
  <span class="nx">chart</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h3 id="36-food-database">3.6 Food Database</h3>
<p>As stated before, we obtained our data directly from
<a href="https://ndb.nal.usda.gov/ndb/">USDA's website</a>.</p>
<p>The original database contained over 8000 entries of foods, which included
many restaurant foods such as ones from McDonalds or Burger King. We felt that
this would only clog up the search results when users would be trying to find
ingredients more suited for cooking at home, and thus we manually removed them
from the database.</p>
<p>Some of the feedback given to us was that the ingredient choices are too 
complicated and that we could perhaps simplify them because users might not
like that level of complexity (e.g. it is tedious to look through the ingredient
autocomplete list for similar food choices). However, this is a limitation that
we chose to accept from the beginning. We knew that we would be using a pre-set
source for the food database in order to implement our autocomplete feature.
Here are some of the alternatives that we had but ultimately chose to reject:</p>
<ol>
  <li>
    One option would be to find databases with simpler ingredient names. We
    felt that this would defeat the purpose of the calorie counter since the
    level of required specificity would not be there when selecting ingredients.
    For instance, a simpler food database could perhaps simply listed "tomato"
    as part of its ingredient selection. With our current database, we give users
    a choice between different varieties of tomatoes as well as different methods
    of preparation. Again, this kind of specificity would be lost if we had gone
    with a database which is perceived to have simpler ingredient names.
    <br><br>
    <div class='wrapper-center'>
      <img src="../figures/ms3/tomato_selection.png" alt="Tomato autocomplete dropdown list">
      <p>The autocomplete choices that appear in the dropdown list for "tomato"</p>
    </div>
    <br>
  </li>
  <li>
    Another alternative would have been to create our own database but we felt
    that this would not be comprehensive or specific enough. Hence, we decided
    to choose one from a credible source.
  </li>
  <li>
    We could have gone with a database which is more complicated than our current
    one but this could potentially affect the user experience negatively so we
    decided against it.
  </li>
</ol>

<p>Ultimately, the USDA's database was actually the best one that we could
find based on the circumstances. Refer to <a href="#81-difficulty-of-inputting-standard-ingredients">Section 8.1</a>
for more details on how we decided to tackle this problem.</p>
<h2 id="4-user-accounts-and-sign-ins">4. User Accounts and Sign-ins</h2>
<p>User Accounts and Sign-ins were a big part of how we implemented certain
functions within the webapp. Flask has a framework for User Accounts already
available.</p>
<p>While we initially intended to work with Firebase to do Google/Facebook
Sign-ins due to the ease of implementation and security in having established
third-parties handle authentications for us, we decided against this because we
wanted to appreciate the difficulty and security considerations with storing
usernames, passwords and doing secure serverside authentication, and how big of
a topic it is in web security.</p>
<h3 id="41-nist-password-guidelines">4.1 NIST Password Guidelines</h3>
<p>We decided to follow
<a href="https://pages.nist.gov/800-63-3/sp800-63b.html#sec5">NIST's Password Guidelines</a>
(see section 5.1.1) for password authentication, since it seems to be the
standard for password registration for end-users. We followed the following
guidelines:</p>
<p>Passwords should...</p>
<ul>
<li>be at least 8 characters in length</li>
<li>be allowed to be at least 64 characters in length</li>
<li>be able to use all printing ASCII characters as well as spaces</li>
</ul>
<p>According to the guidelines, password hints and secret questions are strongly
discouraged, as are composition rules (1 uppercase, 1 lowercase, 1 special
character, etc).</p>
<h3 id="42-information-transfer">4.2 Information Transfer</h3>
<p>Passing username and passwords back and forth between the front and back-end
was done using HTTPs POST requests. This was required to prevent against
MiTM (man-in-the-middle) attacks.</p>
<h3 id="43-registration">4.3 Registration</h3>
<p>We used Flask's
<a href="https://pypi.org/project/Werkzeug/">Werkzeug</a>
library to handle password hashing and salting. Hashing ensures that we do not
store passwords in plaintext, while salting ensures that similar passwords
don't result in the same hash, and to prevent the use of
<a href="https://en.wikipedia.org/wiki/Rainbow_table">Rainbow Tables</a>.
For example, I made two accounts with the following usernames and passwords:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>user        password
====================
hashed1     123456
hashed2     123456
</pre></div>
</td></tr></table>

<p>The two passwords were hashed and salted to:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>hashed1 password:
pbkdf2:sha256:150000$QBDEP5Jn$3001b4fb44eeb17630b6d9a0089f9b883686bd6ea9a61cec1f8b1ae0ade8e05e

hashed2 password:
pbkdf2:sha256:150000$0o18iF5N$7c406da90ce724f65c896fe931f9bda806fb3f04b55e21d1f9f0f88488b47385

The two hashes are obviously different
</pre></div>
</td></tr></table>

<p>... making it more secure. In the back-end, our code is simply:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/register&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">form</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span>
        <span class="n">hashed_password</span> <span class="o">=</span> <span class="n">generate_password_hash</span><span class="p">(</span><span class="n">form</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">])</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">&lt;</span><span class="n">connect</span> <span class="n">to</span> <span class="n">db</span><span class="o">&gt;</span><span class="p">))</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;INSERT INTO users</span>
<span class="s2">                           (username, password)</span>
<span class="s2">                           VALUES(?, ?)&quot;&quot;&quot;</span><span class="p">,</span>
                           <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">hashed_password</span><span class="p">))</span>
            <span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">IntegrityError</span><span class="p">:</span>
            <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">flash</span><span class="p">(</span><span class="s2">&quot;Username already in use&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&quot;register.html&quot;</span><span class="p">)</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&quot;register.html&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<h3 id="44-logins">4.4 Logins</h3>
<p>Logins were simple. We simply sent the username and password back to the
back-end, and uses Werkzeug's <code class="codehilite"><span class="n">check_password_hash</span><span class="p">()</span></code> function to check if the
given password matched the hashed password in our database. If it matches,
it logs the user in and redirects the user to the front-page.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">form</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span>
<span class="n">username</span> <span class="o">=</span> <span class="n">form</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">form</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ROOT</span><span class="p">,</span> <span class="s2">&quot;slim_jeans.db&quot;</span><span class="p">))</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT * FROM users WHERE username = (?)&quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span><span class="n">username</span><span class="p">,))</span>
<span class="n">userInformation</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">userInformation</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> \
    <span class="ow">not</span> <span class="n">check_password_hash</span><span class="p">(</span><span class="n">userInformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">password</span><span class="p">):</span>
    <span class="n">flash</span><span class="p">(</span><span class="s2">&quot;Invalid username and/or password&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&quot;login.html&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">session</span><span class="p">[</span><span class="s2">&quot;user_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">userInformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">session</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">userInformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<h3 id="45-session-id">4.5 Session ID</h3>
<p>The user's user id (as stored in the SQL database upon registration) and
username is stored after logging in. The Python code that handles this is
as follows:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">session</span><span class="p">[</span><span class="s2">&quot;user_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">userInformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">session</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">userInformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>Flask has a session object which deals with user information during web
browsing, while <code class="codehilite"><span class="n">userInformation</span></code> is a 2D array that contains the user's
information after querying the database. In this way, we can use Flask to pass
user information to the front-end, which can then be accessed with the Jinja2
templating language. This allows us to keep track of things such as whether a
user is logged in and render the website accordingly. For instance, the top
navbar will have different options for users who are logged in.</p>
<h2 id="5-saving-recipes-to-database">5. Saving Recipes to Database</h2>
<p>This feature was surprisingly annoying and frustrating to implement, mostly
due to the handling of events by the Display and Delete buttons. Many of
the problems faced were due to <code class="codehilite"><span class="n">async</span></code> on the front-end, rather than the
back-end.</p>
<h3 id="51-front-end">5.1 Front-end</h3>
<p>We had a few versions of this page using vanilla Javascript. But this proved
to be very time-consuming and frustrating to work with. In the end, we ended up
going with the
<a href="https://datatables.net/">DataTables</a>
library, which allowed us to more easily create a table with additional
functionality, that also allowed styling via Bootstrap.</p>
<p>The table displays the <strong>recipe name</strong> and <strong>number of calories</strong> of each recipe
stored into the user account using the calorie counter. We give the users
two additional functionality in the form of two buttons in each row:</p>
<div class="md-typeset__scrollwrap">
  <div class="md-typeset__table">
    <table>
      <thead>
        <tr>
          <th align="center">Button</th>
          <th align="center">Function</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="button1" align="center">
            <button class='btn btn-block btn-primary btn-sm'
                    style='width: 80px;'
                    onclick='toggleDisplayButton(this)'>Display</button>
          </td>
          <td align="left">
            Shows more information about the recipe. This uses DataTable's
            <a href="https://datatables.net/examples/api/row_details.html">child rows</a>
            API, where more information can be dynamically inserted into the
            table
          </td>
        </tr>
        <tr>
          <td class="button2" align="center">
            <button class='btn btn-block btn-danger btn-sm'
                    style='width: 80px;'
                    onclick='toggleDelete()'>Delete</button>
          </td>
          <td align="left">
            Deletes the recipe from the table (and database). While DataTable's
            does offer an API to delete rows from the table, we needed to
            handle reinserting the same row into the table for the "Undo"
            feature ourselves.
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<h4 id="delete">"Delete"</h4>
<p>The "delete" functionality posed some challenges for us. Firstly, <code class="codehilite"><span class="n">ajax</span></code>
requests are asynchronous, and so making an <code class="codehilite"><span class="n">ajax</span></code> call every time the user
deletes something caused some problems with the code (functions not returning
until <code class="codehilite"><span class="n">ajax</span></code> request has finished, causing <code class="codehilite"><span class="k">null</span></code> in some variables, etc). So,
we ended up storing the names of the recipes that were to be deleted in an
array (a "fake" delete, as it were), and executing an <code class="codehilite"><span class="n">ajax</span></code> request to delete
all the recipes from the database once the page is unloaded.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;unload&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">toDelete</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="s2">&quot;/delete_recipe_data&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
      <span class="nx">contentType</span><span class="o">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
      <span class="nx">dataType</span><span class="o">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
      <span class="nx">data</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
        <span class="s2">&quot;recipeName&quot;</span><span class="o">:</span> <span class="nx">toDelete</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
      <span class="p">})</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</td></tr></table>

<p>It also turned out that doing this method made the <code class="codehilite"><span class="n">undo</span></code> button easier to
implement as well.</p>
<h3 id="52-undo">5.2 <code class="codehilite"><span class="n">undo</span></code></h3>
<p>This was suggested to us by a user during our testing, more information can be
found in <a href="#84-undo-functionality">Section 8.4</a></p>
<h3 id="53-back-end">5.3 Back-end</h3>
<p>Flask has a <code class="codehilite"><span class="n">jsonify</span><span class="p">()</span></code> method to pass JSON objects back to the
front-end Javascript. Conversely, Javascript's jQuery has the ability to make
an <code class="codehilite"><span class="n">ajax</span></code> request to the Python back-end to send data back. This is how the
front-end communicates with the SQL database in the back-end. So, to send
data back to the back-end, an <code class="codehilite"><span class="n">ajax</span></code> request may look something like this:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">...;</span> <span class="c1">// recipe data goes here</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="s2">&quot;/func_name&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
    <span class="nx">contentType</span><span class="o">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
    <span class="nx">dataType</span><span class="o">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="p">}).</span><span class="nx">done</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="c1">// do something after function returns</span>
<span class="p">})</span>
</pre></div>
</td></tr></table>

<p>When the Python function returns from the back-end, <code class="codehilite"><span class="na">.done</span><span class="p">()</span></code> is used to
continue the running of the Javascript after the <code class="codehilite"><span class="n">ajax</span></code> request is finished.</p>
<p>In the back-end, the Python function looks like:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/func_name&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">])</span>
<span class="nd">@login_required</span>
<span class="k">def</span> <span class="nf">func_name</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
      <span class="c1"># make SQL requests and deletes from database</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&quot;my_page.html&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Due to the way we delete recipes form the database, we do not allow
duplicate recipe names inside the database. This is done using an SQL
<code class="codehilite"><span class="k">SELECT</span></code> first:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">exists</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT 1</span>
<span class="s2">                           FROM recipes</span>
<span class="s2">                           WHERE username = (?) AND recipe_name = (?)&quot;&quot;&quot;</span><span class="p">,</span>
                           <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">recipe_name</span><span class="p">))</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>Then check <code class="codehilite"><span class="k">if</span> <span class="ss">(</span><span class="nv">exists</span><span class="ss">)</span></code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">exists</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="s2">&quot;Recipe already exists&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;INSERT INTO recipes</span>
<span class="s2">                      (username, recipe_name, recipe, calories)</span>
<span class="s2">                      VALUES(?, ?, ?, ?)&quot;&quot;&quot;</span><span class="p">,</span>
                      <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">recipe_name</span><span class="p">,</span> <span class="n">recipe</span><span class="p">,</span> <span class="n">calories</span><span class="p">))</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="s2">&quot;Recipe saved&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<h3 id="54-method-of-storage">5.4 Method of Storage</h3>
<p>We store each recipe along with its recipe name, number of calories and
the date and time at which it was saved at inside our database. The individual
ingredient information iss stored in a large JSON string such as the following:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">{</span><span class="ss">&quot;ingredient1&quot;</span><span class="p">:</span><span class="err">{</span><span class="ss">&quot;description&quot;</span><span class="p">:</span><span class="ss">&quot;Avocados, raw, California&quot;</span><span class="p">,</span><span class="ss">&quot;amount&quot;</span><span class="p">:</span><span class="ss">&quot;200&quot;</span><span class="p">,</span><span class="ss">&quot;unit&quot;</span><span class="p">:</span><span class="ss">&quot;grams&quot;</span><span class="p">,</span><span class="ss">&quot;calories&quot;</span><span class="p">:</span><span class="mi">333</span><span class="p">.</span><span class="mi">9130434782609</span><span class="err">}</span><span class="p">,</span><span class="ss">&quot;ingredient2&quot;</span><span class="p">:</span><span class="err">{</span><span class="ss">&quot;description&quot;</span><span class="p">:</span><span class="ss">&quot;Milk, canned, condensed, sweetened&quot;</span><span class="p">,</span><span class="ss">&quot;amount&quot;</span><span class="p">:</span><span class="ss">&quot;0.75&quot;</span><span class="p">,</span><span class="ss">&quot;unit&quot;</span><span class="p">:</span><span class="ss">&quot;cups&quot;</span><span class="p">,</span><span class="ss">&quot;calories&quot;</span><span class="p">:</span><span class="mi">738</span><span class="err">}</span><span class="p">,</span><span class="ss">&quot;ingredient3&quot;</span><span class="p">:</span><span class="err">{</span><span class="ss">&quot;description&quot;</span><span class="p">:</span><span class="ss">&quot;Milk, whole, 3.25% milkfat, with added vitamin D&quot;</span><span class="p">,</span><span class="ss">&quot;amount&quot;</span><span class="p">:</span><span class="ss">&quot;0.75&quot;</span><span class="p">,</span><span class="ss">&quot;unit&quot;</span><span class="p">:</span><span class="ss">&quot;cups&quot;</span><span class="p">,</span><span class="ss">&quot;calories&quot;</span><span class="p">:</span><span class="mi">111</span><span class="p">.</span><span class="mi">75</span><span class="err">}</span><span class="p">,</span><span class="ss">&quot;ingredient4&quot;</span><span class="p">:</span><span class="err">{</span><span class="ss">&quot;description&quot;</span><span class="p">:</span><span class="ss">&quot;Lime juice, raw&quot;</span><span class="p">,</span><span class="ss">&quot;amount&quot;</span><span class="p">:</span><span class="ss">&quot;1&quot;</span><span class="p">,</span><span class="ss">&quot;unit&quot;</span><span class="p">:</span><span class="ss">&quot;tablespoons&quot;</span><span class="p">,</span><span class="ss">&quot;calories&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">.</span><span class="mi">75</span><span class="err">}}</span>
</pre></div>
</td></tr></table>

<p>This is generated from the front-end when the user saves the recipe. The
information is saved to an object and the <code class="codehilite"><span class="n">JSON</span><span class="o">.</span><span class="n">stringify</span><span class="p">()</span></code> method is
used to convert it to a string.</p>
<p>Fortunately, we are able to use Flask's <code class="codehilite"><span class="n">jsonify</span><span class="p">()</span></code> method to convert
this long string into a Javascript Object that can be processed by the front-end
to display the user's saved recipes.</p>
<h2 id="6-night-mode">6. Night Mode</h2>
<p>Inspired by NUSMods, this was suggested as a joke during one of our meetings.
We eventually decided to implement it in our webpages. There's a sun/moon icon
in the navbar which toggles night mode for the website.</p>
<p>It was primarily done using jQuery, we selected the <code class="codehilite"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span></code> tag to add a
CSS class <code class="codehilite"><span class="nt">class</span><span class="o">=</span><span class="s1">&#39;dark&#39;</span></code>. From there, we used CSS to edit the font and
background color of each elemnt in order to style the page in this way.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nt">body</span><span class="p">.</span><span class="nc">dark</span> <span class="p">{</span>
    <span class="k">background-color</span><span class="p">:</span> <span class="nb">rgb</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">43</span><span class="p">);</span>
    <span class="k">color</span><span class="p">:</span> <span class="kc">white</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* other nitty-gritty css omitted */</span>
</pre></div>
</td></tr></table>

<p>For tables, we could use Bootstrap's <code class="codehilite">table-dark</code> implementation and just
add <code class="codehilite"><span class="k">class</span>=<span class="s">&#39;table-dark&#39;</span></code> to each table to style it as such</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;table-id&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;table-dark&#39;</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>We had some issues implementing this with DataTable's library however, and had
to override some of their own CSS styling in order to successfully implement
proper night mode functionality in all our webpages.</p>
<h2 id="7-graph-generator">7. Graph Generator</h2>
<div class="wrapper-center">
  <img src="../figures/ms3/graph_generator.png" alt="Example graph">
  <p>Example graph</p>
</div>

<h3 id="71-rationale">7.1 Rationale</h3>
<p>We decided to implement a graph generator in order to show users a visual
representation of the calories of the recipes that they've stored in the
past. We gave users the option to display 5, 10, 15, 20 or all stored recipes.
This is useful to have a side by side comparison across different recipes
and time periods.</p>
<h3 id="72-implementation">7.2 Implementation</h3>
<p>We used the <a href="https://developers.google.com/chart/interactive/docs/gallery/columnchart">Google Charts API</a>
to render our graph. The data is passed to the API from our stored recipes
database. Google's Charts API comes with in-built interactivity which is
useful for displaying additional data whenever a user hovers over one of
the columns in the column chart.</p>
<h2 id="8-user-testing">8. User Testing</h2>
<p>We gave it to a few friends and family members who actually cook and see if
they liked the features. Here is some feedback that we have gathered.</p>
<h3 id="81-difficulty-of-inputting-standard-ingredients">8.1 Difficulty of Inputting Standard Ingredients</h3>
<p>One of the criticisms we got from users was that it was difficult to input
ingredients such Potatoes, Carrots or Onions as no recipe gives the <em>weight</em> of
such ingredients, but rather their <em>number</em>. For example, most recipes list
such ingredients as:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>1 medium carrot
1 small onion
...

rather than:

61g of carrots
30g of onions
</pre></div>
</td></tr></table>

<p>We decided to manually add common ingredients such as potatoes, carrots, onions,
tomatoes, etc into the database with <code class="codehilite"><span class="n">unit</span></code> units, making it easier for
users to input such ingredients.</p>
<p>We also decided to add some notes regarding some common ingredients since they
are represented differently in the food database than what we are normally
used to. One example is clarifying that salt falls under "Salt, table" to
make it easier for users to find.</p>
<h3 id="82-error-handling">8.2 Error Handling</h3>
<p>One of our tech savvy friends tried to break the website by visiting website
paths that did not exist as well as those that only exist as Python Flask
functions. This resulted in a lot of server errors and would not make for a
good user experience if users were to encounter them. We added in some
generalised error handling code to handle all HTTP exceptions.</p>
<h3 id="83-meaningful-user-interactions-with-the-ui">8.3 Meaningful User Interactions with the UI</h3>
<p>Another piece of feedback which was given to us was that some users did not
receive feedback upon completing certain actions. For instance, upon successful
registration, users were brought back to the home page but were not told that
their registration was successful. We implemented some feedback mechanisms
(mainly JavaScript alerts and Flask's message flashing) in order to give users
more meaningful information once they had finished certain actions.</p>
<p><div id='alert-1'
       class="alert alert-danger alert-dismissible fade show text-center message-flash" role="alert">
    Old password does not match
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">×</span>
    </button>
  </div></p>
<h3 id="84-undo-functionality">8.4 <code class="codehilite"><span class="n">undo</span></code> Functionality</h3>
<p>One of our users, while exploring the saved recipes page on an example
account, accidentally clicked off a Delete on one of the recipes. After a
"sorry", we realised that this could happen to any other user.</p>
<p>The first thing we did was put in an alert to confirm whether the user
wanted to delete the recipe. After that, we implemented an <code class="codehilite"><span class="n">undo</span></code> functionality.
We implemented this using Bootstrap alerts:</p>
<div id='alert-2'
     class="alert alert-warning alert-dismissible fade show" role="alert">
  Deleted "recipe_name".
  <button type="button" class="btn btn-link btn-sm">
    Undo
  </button>
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<p>The <code class="codehilite"><span class="n">undo</span></code> button's event was handled by jQuery, the function acquires
the data from a large JSON object, appends it to the table and redraws
the table. The "fake delete" array is updated as well.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Function to handle undo event for a specific recipe.</span>
<span class="cm"> * @param {string} recipeName - name of recipe associated with this button</span>
<span class="cm"> * @param {object} recipes - list of all recipes and their data</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">handleUndoOnClick</span><span class="p">(</span><span class="nx">recipeName</span><span class="p">,</span> <span class="nx">recipes</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;#undo-&#39;</span>
      <span class="o">+</span> <span class="nx">replaceSpacesWithUnderscores</span><span class="p">(</span><span class="nx">recipeName</span><span class="p">),</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">findRecipe</span><span class="p">(</span><span class="nx">recipeName</span><span class="p">,</span> <span class="nx">recipes</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">row</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#sr-recipe-table&#39;</span><span class="p">).</span><span class="nx">DataTable</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">row</span>
        <span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">row</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
      <span class="nx">toDelete</span> <span class="o">=</span> <span class="nx">toDelete</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">names</span> <span class="p">=&gt;</span> <span class="nx">names</span> <span class="o">!==</span> <span class="nx">recipeName</span><span class="p">);</span>
      <span class="nx">insertAlert</span><span class="p">(</span><span class="nx">createUndoneAlert</span><span class="p">());</span>
      <span class="nx">deleteAlert</span><span class="p">(</span><span class="nx">recipeName</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">})</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="9-project-conclusion">9. Project Conclusion</h2>
<p>We would say that we have learnt greatly from Orbital, particularly the
many APIs and frameworks (and lack thereof) we have had the pleasure of using,
such as Flask, Jinja2, SQLite, etc and the other technologies such as HTML5,
CSS and native Javascript.</p>
<p>Doing this project using native Javascript has also allowed us to appreciate
new web frameworks such as React, Vue or Angular that abstracts the nitty-gritty
of direct DOM manipulation and state changes. Even trying to create and insert
a table into a webpage is long-winded and cumbersome to do!</p>
<p>We feel that we could have done more to improve the website, such as
optimising it for mobile as well as implemented other features which
we had in mind, but we simply did not have the time to work these
imporvements.</p>
<p>Regardless, no matter what level of achievement we end up obtaining for
Orbital, this has been a fruitful and memorable project which has
taught us a lot about web development and software engineering concepts.</p>
<h2 id="10-deliverables">10. Deliverables</h2>
<h3 id="101-poster">10.1 Poster</h3>
<p><div class='wrapper-center'>
  <img src="../figures/ms3/poster.png" alt="poster">
</div></p>
<h3 id="102-project-log">10.2 Project Log</h3>
<p>Our project log is documented
<a href="https://docs.google.com/spreadsheets/d/17kEtNaCyYZzXc2UWd6ss4zXTWQ4-QY7XN3ODB6DpEJs/edit?usp=sharing">in this Google Sheet</a></p>
<h3 id="103-video">10.3 Video</h3>
<p><div class='wrapper-center'>
  <iframe width="640"
          height="360"
          src="https://www.youtube.com/embed/se1fP5lb1ug"
          frameborder="0"
          allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen></iframe>
</div></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../milestone_two/" title="Two" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Two
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.39abc4af.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.jso"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
      
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
      
        <script src="../scripts/extra.js"></script>
      
    
  </body>
</html>